import{A as z}from"./AppLayout-5088345b.js";import{j as T,k as n,o as g,c as j,w as l,a as e,b as a,f as V,l as P,t as _,F,m as h,d as p,e as O,n as v}from"./app-6f367f05.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import"./ApplicationLogo-691d4996.js";const M={components:{AppLayout:z,Link:T},data(){return{loading:!1,dialog:!1,deleting:!1,fetchingsuppliers:!0,storevalid:!1,updatevalid:!1,suppliers:[],total:0,options:{},dialogDelete:!1,itemsperpageoptions:[{title:"10",value:10},{title:"25",value:25},{title:"50",value:50},{title:"100",value:100},{title:"Tous",value:-1}],itemsperpagetext:"Lignes par page",headers:[{title:"Nom",align:"start",sortable:!1,key:"name"},{title:"Téléphone",sortable:!1,key:"code"},{title:"Adresse",sortable:!1,key:"rib"},{title:"Actions",key:"actions",align:"center",sortable:!1}],defaultItem:{name:"",adresse:"",telephone:"",bank_name:"",bank_code:"",bank_rib:""},deletedId:-1,deletedIndex:-1,editedIndex:-1,editedId:-1,editedItem:[],editedIndex:-1,nameRules:[s=>s?!0:"Le nom du fournisseur est obligatoire"],bank_nameRules:[s=>s?!0:"Le nom de la banque est obligatoire"],bank_codeRules:[s=>s?!0:"Le code de la banque est obligatoire"],bank_ribRules:[s=>s?!0:"Le RIB de la banque est obligatoire",s=>/\D/.test(s)?"Le RIB ne peut contenir que des chiffres":!0,s=>(s==null?void 0:s.length)<=24?!0:"Vous ne pouvez pas dépasser 24 chiffres",s=>(s==null?void 0:s.length)===24?!0:"Le RIB doit contenir 24 chiffres"]}},watch:{dialogDelete(s){s||this.closeDelete()}},mounted(){this.LoadData(),this.$watch("options",{handler(){return this.LoadData()},deep:!0})},computed:{count(){return this.suppliers.length},formTitle(){return this.editedIndex===-1?"Nouveau fournisseur":"Modification de founrisseur"}},methods:{async LoadData(){this.fetchingsuppliers=!0;try{const s=await axios.get("/webapisuppliers",{params:{page:this.options.page,itemsPerPage:this.options.itemsPerPage,search:this.options.search}});this.suppliers=[],s.data.suppliers.data.length&&(this.suppliers=s.data.suppliers.data,this.total=s.data.total)}catch{}this.fetchingsuppliers=!1},store(){this.$refs.storeform.validate().then(()=>{this.storevalid&&(this.loading=!0,this.editedIndex===-1?this.$inertia.post(route("suppliers.store"),{name:this.editedItem.name,adresse:this.editedItem.adresse,telephone:this.editedItem.telephone,bank_name:this.editedItem.bank_name,bank_code:this.editedItem.bank_code,bank_rib:this.editedItem.bank_rib},{onSuccess:async()=>{this.loading=!1,this.close(),await this.LoadData()},preserveScroll:!0}):this.$inertia.post(route("suppliers.update",this.editedId),{_method:"put",name:this.editedItem.name,adresse:this.editedItem.adresse,telephone:this.editedItem.telephone,bank_name:this.editedItem.bank_name,bank_code:this.editedItem.bank_code,bank_rib:this.editedItem.bank_rib},{onSuccess:async()=>{this.loading=!1,this.close(),await this.LoadData()},preserveScroll:!0}))})},close(){this.dialog=!1,this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1,this.editedId=-1},deleteItem(s){this.deletedIndex=this.suppliers.indexOf(s),this.deletedId=s.id,this.dialogDelete=!0},closeDelete(){this.deletedId=null,this.dialogDelete=!1},deleteItemConfirm(){this.deleting=!0,this.$inertia.delete(route("suppliers.destroy",this.deletedId),{onSuccess:()=>{this.deleting=!1,this.closeDelete(),this.count===0&&this.options.page>1?this.options.page--:this.LoadData()},preserveScroll:!0})},editItem(s){this.editedIndex=this.suppliers.indexOf(s),this.editedItem=Object.assign({},s),this.editedId=s.id,this.dialog=!0}}},X=a("h1",{class:"font-semibold text-3xl text-gray-800 leading-tight"},"Fournisseurs",-1),G={class:"font-bold text-gray-600"},H={class:"text-h6 font-bold"},J=a("span",null,"Achats",-1),K=a("span",null,"Editer",-1),Q=a("span",null,"Supprimer",-1),W=a("tr",null,[a("td",{colspan:"4",class:"border-0 h-0"})],-1),Y={class:"rounded-full bg-opacity-20 p-2 mr-2 bg-red-500"};function Z(s,i,$,ee,t,d){const u=n("v-text-field"),L=n("v-divider"),C=n("v-spacer"),r=n("v-btn"),I=n("v-card-title"),m=n("v-col"),f=n("v-row"),D=n("v-container"),w=n("v-card-text"),k=n("v-card-actions"),x=n("v-card"),R=n("v-form"),y=n("v-dialog"),U=n("v-toolbar"),A=n("Link"),b=n("v-tooltip"),S=n("v-data-table-server"),B=n("v-icon"),N=n("AppLayout");return g(),j(N,{title:"Fournisseurs"},{header:l(()=>[X]),default:l(()=>[e(S,{headers:t.headers,"items-length":t.total,items:t.suppliers,"loading-text":"Chargement...",loading:t.fetchingsuppliers,hover:"","items-par-page":t.options.itemsperpage,"items-per-page-text":t.itemsperpagetext,"items-per-page-options":t.itemsperpageoptions,"no-data-text":"Aucune donnée disponible dans la table",class:"border rounded shadow-lg text-sm","onUpdate:options":i[9]||(i[9]=o=>t.options=o)},{headers:l(()=>[a("tr",null,[(g(!0),V(F,null,P(t.headers,o=>(g(),V("th",null,[a("span",G,_(o.title.toUpperCase()),1)]))),256))])]),top:l(()=>[e(U,{color:"white",border:"b",flat:""},{default:l(()=>[e(u,{"prepend-inner-icon":"mdi-magnify",modelValue:t.options.search,"onUpdate:modelValue":i[0]||(i[0]=o=>t.options.search=o),variant:"underline",label:"Rechercher",clearable:"","single-line":"","hide-details":""},null,8,["modelValue"]),e(L,{class:"mx-4",inset:"",vertical:""}),e(C),e(y,{modelValue:t.dialog,"onUpdate:modelValue":i[8]||(i[8]=o=>t.dialog=o),"max-width":"500px",persistent:""},{activator:l(({props:o})=>[e(r,h({"prepend-icon":"mdi-account-plus",color:"blue-accent-4",class:"mr-3",variant:"flat"},o),{default:l(()=>[p(" Nouveau fournisseur ")]),_:2},1040)]),default:l(()=>[e(R,{modelValue:t.storevalid,"onUpdate:modelValue":i[7]||(i[7]=o=>t.storevalid=o),disabled:t.loading,onSubmit:O(d.store,["prevent"]),ref:"storeform"},{default:l(()=>[e(x,null,{default:l(()=>[e(I,{class:"border-b bg-gray-50"},{default:l(()=>[a("span",H,_(d.formTitle),1)]),_:1}),e(w,{class:"max-h-96 overflow-y-auto"},{default:l(()=>[e(D,null,{default:l(()=>[e(f,null,{default:l(()=>[e(m,{cols:"12",sm:"6"},{default:l(()=>[e(u,{modelValue:t.editedItem.name,"onUpdate:modelValue":i[1]||(i[1]=o=>t.editedItem.name=o),label:"Nom",variant:"outlined",placeholder:"Société X",rules:t.nameRules},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"12",sm:"6"},{default:l(()=>[e(u,{modelValue:t.editedItem.telephone,"onUpdate:modelValue":i[2]||(i[2]=o=>t.editedItem.telephone=o),variant:"outlined",label:"Téléphone",placeholder:"0666666666"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(u,{modelValue:t.editedItem.adresse,"onUpdate:modelValue":i[3]||(i[3]=o=>t.editedItem.adresse=o),variant:"outlined",class:"mt-1",label:"Adresse"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(m,{cols:"12",sm:"6"},{default:l(()=>[e(u,{modelValue:t.editedItem.bank_name,"onUpdate:modelValue":i[4]||(i[4]=o=>t.editedItem.bank_name=o),variant:"outlined",class:"mt-1",label:"Nom de la banque",rules:t.bank_nameRules},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"12",sm:"6"},{default:l(()=>[e(u,{modelValue:t.editedItem.bank_code,"onUpdate:modelValue":i[5]||(i[5]=o=>t.editedItem.bank_code=o),variant:"outlined",class:"mt-1",label:"Code de la banque",rules:t.bank_codeRules},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(f,null,{default:l(()=>[e(m,{cols:"12"},{default:l(()=>[e(u,{modelValue:t.editedItem.bank_rib,"onUpdate:modelValue":i[6]||(i[6]=o=>t.editedItem.bank_rib=o),variant:"outlined",class:"mt-1",counter:"24",label:"RIB",rules:t.bank_ribRules},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{class:"bg-gray-100 flex justify-end items-center border-t"},{default:l(()=>[e(r,{color:"gray",class:"mt-2",variant:"text",disabled:t.loading,onClick:d.close},{default:l(()=>[p("Annuler")]),_:1},8,["disabled","onClick"]),e(r,{color:"blue-accent-4",type:"submit",class:"mt-2",active:"",variant:"flat",loading:t.loading},{default:l(()=>[p("Enregistrer")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","disabled","onSubmit"])]),_:1},8,["modelValue"])]),_:1})]),item:l(({item:o})=>[a("tr",null,[a("td",{class:v({"text-gray-400":t.fetchingsuppliers})},_(o.name),3),a("td",{class:v({"text-gray-400":t.fetchingsuppliers})},_(o.telephone),3),a("td",{class:v({"text-gray-400":t.fetchingsuppliers})},_(o.adresse),3),a("td",null,[e(b,{location:"bottom",origin:""},{activator:l(({props:c})=>[e(A,{href:s.route("purchases.index",{supplier:o.id})},{default:l(()=>[e(r,h({icon:"mdi-bank-transfer-out",variant:"text"},c,{size:"small",disabled:t.fetchingsuppliers,color:"grey-darken-3",class:"me-2"}),null,16,["disabled"])]),_:2},1032,["href"])]),default:l(()=>[J]),_:2},1024),e(b,{location:"bottom",origin:""},{activator:l(({props:c})=>[e(r,h({icon:"mdi-pencil",onClick:q=>d.editItem(o),variant:"text"},c,{size:"small",disabled:s.fetchingfournisseurs,color:"grey-darken-3",class:"me-2"}),null,16,["onClick","disabled"])]),default:l(()=>[K]),_:2},1024),e(b,{location:"bottom",origin:""},{activator:l(({props:c})=>[e(r,h({icon:"mdi-delete",variant:"text",disabled:s.fetchingfournisseurs,color:"red",onClick:q=>d.deleteItem(o)},c,{size:"small",class:"me-2"}),null,16,["disabled","onClick"])]),default:l(()=>[Q]),_:2},1024)])]),W]),_:1},8,["headers","items-length","items","loading","items-par-page","items-per-page-text","items-per-page-options"]),e(y,{modelValue:t.dialogDelete,"onUpdate:modelValue":i[10]||(i[10]=o=>t.dialogDelete=o),"max-width":"550px"},{default:l(()=>[e(x,null,{default:l(()=>[e(I,{class:"my-2 text-h7"},{default:l(()=>[a("span",Y,[e(B,{color:"red",size:"small",class:"mb-1",icon:"mdi-alert-outline",variant:"tonal"})]),p(" Êtes-vous sur de vouloir supprimer ce fournisseur? ")]),_:1}),e(k,{class:"bg-gray-100 flex justify-end items-center border-t"},{default:l(()=>[e(r,{color:"gray",class:"mt-2",variant:"text",disabled:t.deleting,onClick:d.closeDelete},{default:l(()=>[p("Annuler")]),_:1},8,["disabled","onClick"]),e(r,{color:"red",class:"mt-2",active:"",variant:"flat",loading:t.deleting,onClick:d.deleteItemConfirm},{default:l(()=>[p("Confirmer")]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ie=E(M,[["render",Z]]);export{ie as default};
